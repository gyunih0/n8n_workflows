# Parnas 호텔 매출 집계 자동화 워크플로우 (n8n)

## 🌟 개요

본 프로젝트는 **n8n 워크플로우**를 활용하여 Parnas 호텔의 **월별 매출 집계, 데이터 분석 및 리포트 공유 프로세스**를 자동화합니다.  
기존 수작업 중심의 매출 집계 과정을 자동화함으로써 **업무 효율성 향상**과 **데이터 기반의 신속한 의사결정 지원**을 목표로 합니다.

---

## 🎯 목표

- 매달 반복적으로 진행되던 **수기 매출 집계 업무 자동화**  
- 집계 및 분석이 완료된 **매출 데이터 시트 자동 업데이트 및 공유**  
- AI 기반의 **매출 분석·요약 리포트 자동 생성 및 이메일 발송**  

---

## 🛠️ 기술 스택

- **n8n(self-hosted)**: 워크플로우 자동화 플랫폼
- **Parnas CRS API**: 파르나스 예약관리시스템 내부 API
- **Google Sheets**: 매출 데이터 저장 및 관리 (`파르나스 매출 데이터` 시트 업데이트)  
- **Google Drive**: 분석된 파일 공유  
- **Google Contacts**: 담당자 이메일 주소 조회  
- **AI Agent (LangChain)**: Google Sheet 데이터 공유, 분석 및 요약 리포트 생성
- **OpenAI Chat Model (GPT-4o)**: AI Agent의 언어 모델로 사용
- **Python**: Code Node 내용 작성

---

## 📊 워크플로우
![img](https://github.com/gyunih0/n8n_workflows/blob/main/Parnas%20%EB%A7%A4%EC%B6%9C%20%EC%A7%91%EA%B3%84%20%EC%9E%90%EB%8F%99%ED%99%94%20/Workflow%20Image.png?raw=true)

---

## ⚙️ 워크플로우 동작 순서

1. **워크플로우 시작 (스케줄 트리거)**  
   - 매월 1일 오전 9시 자동 실행  

2. **데이터 수집 (Parnas CRS API 연동)**  
   - Access Token 발급  
   - 전월 체크아웃 기준 예약 목록 조회  
   - 예약목록 데이터 추출  
   - `매출 구하기(Code node, python)`으로 호텔/월/회원 매출 집계

3. **데이터 저장 및 분석 (Google Sheets + AI Agent)**  
   - `파르나스 매출 데이터` 시트에 매출 데이터 **append/update**  
   - AI Agent + GPT-4o 모델을 활용하여 매출 데이터 분석 및 요약 리포트 생성  
   - 분석 내용 예시:
     - 월별 매출 비교  
     - 회원/비회원 매출 비중  
     - 비회원 비율이 높거나 낮은 호텔 하이라이트  
     - 호텔별 매출 트렌드 (상위 3개 / 성장률 상위 3개 / 감소 추세 호텔)  

4. **결과 공유 (Google Drive + 이메일 발송)**  
   - Google Contacts에서 담당자 이메일 조회  
   - Google Drive를 통해 `파르나스 매출 데이터` 파일 **읽기 권한 부여 및 공유**  
   - AI Agent가 생성한 **매출 요약 리포트(한국어)**를 포함한 이메일 발송  

---

## 🚀 기대 효과

- **업무 효율성 향상**: 매달 반복되던 집계·보고 과정을 자동화 → **시간 절약 및 인적 오류 감소**  
- **데이터 기반 의사결정 강화**: AI 분석 리포트 제공 → **매출 트렌드 파악 및 신속한 의사결정 지원**  

---

## 💡 향후 개선 방향

- **분석 데이터셋 고도화**: 실제 요구사항에 맞는 지표와 데이터 처리 로직 추가 필요  
- **알림 채널 확장 검토**: 현재는 이메일 공유 방식 → 추후 **Jira 티켓 등록 프로세스** 등으로 확장 가능성 검토  

---

📌 본 워크플로우는 `n8n` 환경에서 동작하며, 내부 API 및 Google Workspace 서비스와 연동됩니다.
